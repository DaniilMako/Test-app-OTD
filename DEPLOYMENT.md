# üåê –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ

## –¢–µ–∫—É—â–∞—è —Å–∏—Ç—É–∞—Ü–∏—è

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å–∞–π—Ç –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ –ª–æ–∫–∞–ª—å–Ω–æ (`localhost:3000` –∏ `localhost:8000`). –î–ª—è –¥–æ—Å—Ç—É–ø–∞ –∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ –Ω—É–∂–Ω–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞.

---

## üìã –í–∞—Ä–∏–∞–Ω—Ç—ã —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

### 1. **VPS/–û–±–ª–∞—á–Ω—ã–π —Å–µ—Ä–≤–µ—Ä** (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

#### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:
- VPS —Å –ø—É–±–ª–∏—á–Ω—ã–º IP (DigitalOcean, AWS, Hetzner, Yandex Cloud –∏ —Ç.–¥.)
- –î–æ–º–µ–Ω–Ω–æ–µ –∏–º—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
- SSH –¥–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–µ—Ä—É

#### –®–∞–≥–∏:

1. **–ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Docker:**
```bash
# Ubuntu/Debian
curl -fsSL https://get.docker.com -o get-docker.sh
sh get-docker.sh
sudo usermod -aG docker $USER
```

2. **–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ –ø—Ä–æ–µ–∫—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä:**
```bash
git clone <–≤–∞—à-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π>
cd task6
```

3. **–°–æ–∑–¥–∞–π—Ç–µ `.env` —Ñ–∞–π–ª:**
```env
POSTGRES_DB=otd
POSTGRES_USER=postgres
POSTGRES_PASSWORD=–≤–∞—à_–Ω–∞–¥–µ–∂–Ω—ã–π_–ø–∞—Ä–æ–ª—å
SECRET_KEY=–≤–∞—à_—Å–µ–∫—Ä–µ—Ç–Ω—ã–π_–∫–ª—é—á_–¥–ª—è_jwt
ALLOWED_ORIGINS=http://–≤–∞—à-–¥–æ–º–µ–Ω.com,https://–≤–∞—à-–¥–æ–º–µ–Ω.com
```

4. **–û–±–Ω–æ–≤–∏—Ç–µ `docker-compose.yml`** (–ø–æ—Ä—Ç—ã —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã, –Ω–æ –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å)

5. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ:**
```bash
docker compose up -d --build
```

6. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Ñ–∞–π—Ä–≤–æ–ª:**
```bash
# –û—Ç–∫—Ä–æ–π—Ç–µ –ø–æ—Ä—Ç—ã 80 (HTTP) –∏ 443 (HTTPS)
sudo ufw allow 80/tcp
sudo ufw allow 443/tcp
sudo ufw enable
```

7. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ Nginx –∫–∞–∫ reverse proxy** (–¥–ª—è HTTPS –∏ –¥–æ–º–µ–Ω–∞):

–°–æ–∑–¥–∞–π—Ç–µ `/etc/nginx/sites-available/task6`:
```nginx
server {
    listen 80;
    server_name –≤–∞—à-–¥–æ–º–µ–Ω.com www.–≤–∞—à-–¥–æ–º–µ–Ω.com;

    location / {
        proxy_pass http://localhost:3000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }

    location /api {
        proxy_pass http://localhost:8000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
```

–ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ:
```bash
sudo ln -s /etc/nginx/sites-available/task6 /etc/nginx/sites-enabled/
sudo nginx -t
sudo systemctl reload nginx
```

8. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ SSL (Let's Encrypt):**
```bash
sudo apt install certbot python3-certbot-nginx
sudo certbot --nginx -d –≤–∞—à-–¥–æ–º–µ–Ω.com -d www.–≤–∞—à-–¥–æ–º–µ–Ω.com
```

---

### 2. **–î–æ–º–∞—à–Ω–∏–π —Å–µ—Ä–≤–µ—Ä** (—Å–ª–æ–∂–Ω–µ–µ)

#### –ü—Ä–æ–±–ª–µ–º—ã:
- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π IP
- –ü—Ä–æ–≤–∞–π–¥–µ—Ä –º–æ–∂–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –≤—Ö–æ–¥—è—â–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
- –ù—É–∂–µ–Ω —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π IP –∏–ª–∏ DDNS

#### –†–µ—à–µ–Ω–∏—è:

**–í–∞—Ä–∏–∞–Ω—Ç A: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ ngrok –∏–ª–∏ Cloudflare Tunnel**
```bash
# ngrok (–ø—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–±)
ngrok http 3000
# –ü–æ–ª—É—á–∏—Ç–µ –ø—É–±–ª–∏—á–Ω—ã–π URL —Ç–∏–ø–∞: https://abc123.ngrok.io
```

**–í–∞—Ä–∏–∞–Ω—Ç B: –ù–∞—Å—Ç—Ä–æ–π—Ç–µ DDNS (DuckDNS, No-IP)**
1. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –Ω–∞ duckdns.org
2. –ü–æ–ª—É—á–∏—Ç–µ –ø–æ–¥–¥–æ–º–µ–Ω: `–≤–∞—à-—Å–∞–π—Ç.duckdns.org`
3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ IP
4. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç–æ—Ç –¥–æ–º–µ–Ω –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö

**–í–∞—Ä–∏–∞–Ω—Ç C: –ü—Ä–æ–±—Ä–æ—Å –ø–æ—Ä—Ç–æ–≤ –Ω–∞ —Ä–æ—É—Ç–µ—Ä–µ**
1. –ó–∞–π–¥–∏—Ç–µ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–æ—É—Ç–µ—Ä–∞ (–æ–±—ã—á–Ω–æ 192.168.1.1)
2. –ù–∞–π–¥–∏—Ç–µ "Port Forwarding" / "–í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ —Å–µ—Ä–≤–µ—Ä—ã"
3. –ü—Ä–æ–±—Ä–æ—Å—å—Ç–µ –ø–æ—Ä—Ç 3000 –Ω–∞ IP –≤–∞—à–µ–≥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞
4. –£–∑–Ω–∞–π—Ç–µ –≤–∞—à –≤–Ω–µ—à–Ω–∏–π IP: `curl ifconfig.me`
5. –û—Ç–∫—Ä–æ–π—Ç–µ `http://–≤–∞—à-–≤–Ω–µ—à–Ω–∏–π-ip:3000`

‚ö†Ô∏è **–í–Ω–∏–º–∞–Ω–∏–µ:** –û—Ç–∫—Ä—ã—Ç–∏–µ –ø–æ—Ä—Ç–æ–≤ –Ω–∞ –¥–æ–º–∞—à–Ω–µ–º —Ä–æ—É—Ç–µ—Ä–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ!

---

### 3. **–û–±–ª–∞—á–Ω—ã–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã** (—Å–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π)

#### **Heroku / Railway / Render:**

1. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
2. –£–∫–∞–∂–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É –∑–∞–ø—É—Å–∫–∞: `docker compose up`
3. –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–¥–∞—Å—Ç –ø—É–±–ª–∏—á–Ω—ã–π URL

#### **Docker Hub + VPS:**
1. –°–æ–±–µ—Ä–∏—Ç–µ –æ–±—Ä–∞–∑—ã: `docker build -t –≤–∞—à-–ª–æ–≥–∏–Ω/task6-backend ./backend`
2. –ó–∞–≥—Ä—É–∑–∏—Ç–µ: `docker push –≤–∞—à-–ª–æ–≥–∏–Ω/task6-backend`
3. –ù–∞ VPS: `docker pull –≤–∞—à-–ª–æ–≥–∏–Ω/task6-backend && docker run ...`

---

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ:
1. ‚úÖ –°–º–µ–Ω–∏—Ç–µ –ø–∞—Ä–æ–ª–∏ –ë–î –∏ SECRET_KEY –≤ `.env`
2. ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ HTTPS (Let's Encrypt –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π)
3. ‚úÖ –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Ñ–∞–π—Ä–≤–æ–ª (—Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ –ø–æ—Ä—Ç—ã)
4. ‚úÖ –†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ Docker –æ–±—Ä–∞–∑—ã
5. ‚úÖ –ù–µ —Ö—Ä–∞–Ω–∏—Ç–µ `.env` –≤ Git

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å rate limiting –≤ Nginx
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å fail2ban –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞
- –†–µ–≥—É–ª—è—Ä–Ω–æ –¥–µ–ª–∞—Ç—å –±—ç–∫–∞–ø—ã –ë–î
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–æ–≤

---

## üîß –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ CORS –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö –¥–æ–º–µ–Ω–æ–≤

–í `backend/main.py` CORS –Ω–∞—Å—Ç—Ä–æ–µ–Ω —Ç–æ–ª—å–∫–æ –¥–ª—è `localhost:3000`. –î–ª—è —Ä–∞–±–æ—Ç—ã —Å –≤–Ω–µ—à–Ω–∏–º –¥–æ–º–µ–Ω–æ–º:

1. –î–æ–±–∞–≤—å—Ç–µ –≤ `.env`:
```env
ALLOWED_ORIGINS=http://–≤–∞—à-–¥–æ–º–µ–Ω.com,https://–≤–∞—à-–¥–æ–º–µ–Ω.com,http://localhost:3000
```

2. –û–±–Ω–æ–≤–∏—Ç–µ `backend/main.py`:
```python
import os
from dotenv import load_dotenv

load_dotenv()

allowed_origins = os.getenv("ALLOWED_ORIGINS", "http://localhost:3000").split(",")

app.add_middleware(
    CORSMiddleware,
    allow_origins=allowed_origins,
    allow_credentials=True,
    allow_methods=["*"],
    allow_headers=["*"],
)
```

---

## üìù –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

1. **–§—Ä–æ–Ω—Ç–µ–Ω–¥ –¥–æ—Å—Ç—É–ø–µ–Ω:**
```bash
curl http://–≤–∞—à-–¥–æ–º–µ–Ω.com
```

2. **Backend API —Ä–∞–±–æ—Ç–∞–µ—Ç:**
```bash
curl http://–≤–∞—à-–¥–æ–º–µ–Ω.com/api/docs
```

3. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–∞ –∏–∑–≤–Ω–µ** (–ø–æ—Ä—Ç 5432 –∑–∞–∫—Ä—ã—Ç –≤ —Ñ–∞–π—Ä–≤–æ–ª–µ)

---

## üÜò –ü—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### –°–∞–π—Ç –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞:
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∞–π—Ä–≤–æ–ª: `sudo ufw status`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø–æ—Ä—Ç—ã –æ—Ç–∫—Ä—ã—Ç—ã: `sudo netstat -tulpn | grep :3000`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `docker compose logs`

### CORS –æ—à–∏–±–∫–∏:
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –¥–æ–º–µ–Ω –¥–æ–±–∞–≤–ª–µ–Ω –≤ `ALLOWED_ORIGINS`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –æ–±—Ä–∞—â–∞–µ—Ç—Å—è –∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º—É URL API

### SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ DNS –∑–∞–ø–∏—Å–∏: `dig –≤–∞—à-–¥–æ–º–µ–Ω.com`
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–æ—Ä—Ç 80 –æ—Ç–∫—Ä—ã—Ç –¥–ª—è Let's Encrypt

---

## üìö –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- [Docker Compose –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](https://docs.docker.com/compose/)
- [Let's Encrypt](https://letsencrypt.org/)
- [Nginx reverse proxy](https://nginx.org/en/docs/http/ngx_http_proxy_module.html)
- [DigitalOcean VPS](https://www.digitalocean.com/)
- [Yandex Cloud](https://cloud.yandex.ru/)


