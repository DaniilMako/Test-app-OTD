# ๐ ะะฐะดะฐะฝะธะต 5: ะะตะฐะปะธะทะฐัะธั ัะพะฑััะฒะตะฝะฝะพะณะพ ัะตัะฒะตัะฐ ั KPI ะธ Alembic
**ะะะ ะฟะพ "ะัะฝะพะฒะฐะผ ัะตัะฝะธัะตัะบะพะณะพ ะดะพะบัะผะตะฝัะพะฒะตะดะตะฝะธั"**

ะะฐััะธัะตะฝะธะต React-ะฟัะธะปะพะถะตะฝะธั ั ะดะพะฑะฐะฒะปะตะฝะธะตะผ:
- โ **ะะพะบะฐะปัะฝะพะณะพ FastAPI-ัะตัะฒะตัะฐ**
- โ **ะะฐะทั ะดะฐะฝะฝัั (PostgreSQL)**
- โ **ะฃััั ะฟะพัะตัะตะฝะธะน ะธ ะฒัะตะผะตะฝะธ ะฝะฐ ัััะฐะฝะธัะฐั**
- โ **ะะธะณัะฐัะธะธ ัะตัะตะท Alembic**
- โ **ะกัะฐัะธััะธะบะฐ ะฒ ัะตะฐะปัะฝะพะผ ะฒัะตะผะตะฝะธ**

---

## ๐ ะะฐะบ ะทะฐะฟัััะธัั

## ะขะตัะฟะธะฝะฐะป 1:
### 1. ะฃััะฐะฝะพะฒะธัะต ะทะฐะฒะธัะธะผะพััะธ (React)
```bash
cd task6/frontend
npm install
```

### 2. ะะฐะฟัััะธัะต React-ะฟัะธะปะพะถะตะฝะธะต
```bash
npm start
```
โ ะัะธะปะพะถะตะฝะธะต ะฑัะดะตั ะดะพัััะฟะฝะพ: [http://localhost:3000](http://localhost:3000)

> ๐ก ะัะบัะพะนัะต ะดะฒะฐ ัะตัะผะธะฝะฐะปะฐ: ะพะดะธะฝ ะดะปั ัะตัะฒะตัะฐ, ะพะดะธะฝ ะดะปั React.

---

## ะขะตัะฟะธะฝะฐะป 2:
### 3. ะฃััะฐะฝะพะฒะธัะต ัะตัะฒะตั (Python)
```bash
cd ../backend
python -m venv venv
venv\Scripts\activate   
pip install -r requirements.txt
```

### 4. ะะฐัััะพะนัะต ะะ (.env)
ะกะพะทะดะฐะนัะต ัะฐะนะป (ะตัะปะธ ะตะณะพ ะฝะตั) backend/.env:
```env
DB_HOST=localhost
DB_PORT=5432
DB_NAME=otd
DB_USER=postgres
DB_PASS=admin
```
๐ ะฃะฑะตะดะธัะตัั, ััะพ PostgreSQL ะทะฐะฟััะตะฝ ะธ ะฑะฐะทะฐ otd ัะพะทะดะฐะฝะฐ.

### 5. ะัะธะผะตะฝะธัะต ะผะธะณัะฐัะธะธ
```bash
alembic revision --autogenerate -m "create tables"
alembic upgrade head
```
โ ะกะพะทะดะฐัั ัะฐะฑะปะธัั pages ะธ kpi


### 6. ะะฐะฟัััะธัะต ัะตัะฒะตั (ะฒ ะพัะดะตะปัะฝะพะผ ัะตัะผะธะฝะฐะปะต)
```bash
uvicorn backend.main:app --reload --port 8000
```
โ ะกะตัะฒะตั ะฑัะดะตั ะดะพัััะฟะตะฝ: [http://localhost:8000](http://localhost:8000)

ะะปะธ ะฒัะพัะพะน ะฒะฐัะธะฐะฝั:
```bash
python -m uvicorn backend.main:app --reload --port 8000
```

### 7. ะกะพะทะดะฐะนัะต ัััะฐะฝะธัั ัะตัะตะท Swagger
   1. ะะตัะตะนะดะธัะต: http://localhost:8000/docs
   2. ะัะฟะพะปัะทัะนัะต POST /admin/create_page 4 ัะฐะทะฐ:
```json
{ "title": "ะฒะฒะตะดะตะฝะธะต" }
{ "title": "ะพะฟะธัะฐะฝะธะต" }
{ "title": "ะทะฐะบะปััะตะฝะธะต" }
{ "title": "API" }
```

## ๐ ะัะฝะพะฒะฝัะต ะฒะพะทะผะพะถะฝะพััะธ

- โ **ะะฐะฒะธะณะฐัะธะพะฝะฝะฐั ะฟะฐะฝะตะปั**: ะะตัะตะบะปััะฐะนัะตัั ะผะตะถะดั ะฒะบะปะฐะดะบะฐะผะธ
- โ **ะกะฑะพั KPI**:
   - ๐ ะกััััะธะบ ะฟะพัะตัะตะฝะธะน
   - โฑ๏ธ ะัะตะผั, ะฟัะพะฒะตะดัะฝะฝะพะต ะฝะฐ ัััะฐะฝะธัะต
- โ **ะกัะฐัะธััะธะบะฐ**: ะะบะปะฐะดะบะฐ /stats โ ะพัะพะฑัะฐะถะฐะตั ะฒัะต ะผะตััะธะบะธ
- ๐ **ะะพะบะฐะปัะฝัะน ัะตัะฒะตั**: FastAPI ั ะดะฒัะผั ัะฝะดะฟะพะธะฝัะฐะผะธ:
   - `GET /admin/kpis` โ ััะฐัะธััะธะบะฐ
   - `POST /admin/kpi/{id}/time` โ ะพะฑะฝะพะฒะปะตะฝะธะต ะฒัะตะผะตะฝะธ
   - `GET /posts` โ ะฟะพััั (ะฟัะพะบัะธััะตั JSONPlaceholder)
   - `POST /invert-image` โ ะธะฝะฒะตััะธััะตั ะธะทะพะฑัะฐะถะตะฝะธะต
- โ **Alembic + SQLAlchemy**: Code-first ะฟะพะดัะพะด ะบ ะะ
- ๐ **ะะฐะฟัะพัั ะบ ัะตัะฒะตัั**: React ะพะฑัะฐัะฐะตััั ะบ `http://localhost:8000/posts`
- ๐ผ๏ธ **ะะฑัะฐะฑะพัะบะฐ ะธะทะพะฑัะฐะถะตะฝะธะน**: ะะฐะณััะทะบะฐ โ ะธะฝะฒะตััะธั โ ะพัะพะฑัะฐะถะตะฝะธะต
- ๐ **ะะพะบัะผะตะฝัะฐัะธั API**: /docs, /redoc
- ๐ **ะะตะผะพะธะทะฐัะธั ะดะฐะฝะฝัั**: `useMemo` ะฒ ะบะพะผะฟะพะฝะตะฝัะต "ะะพััั"
- โ **ะัะพะบัะธัะพะฒะฐะฝะธะต API**: GET /posts โ JSONPlaceholder
- ๐ **ะกัะฐะฒะฝะตะฝะธะต ะผะตัะพะดะพะฒ**: `axios` vs `fetch` (ะผะพะถะฝะพ ะฟะตัะตะบะปััะฐัั)

---

## ๐ ะกัััะบัััะฐ ะฟัะพะตะบัะฐ


```
task6/
โ
โโโ backend/
โ   โโโ main.py
โ   โโโ database.py
โ   โโโ config.py
โ   โโโ models/
โ   โ   โโโ models.py           # ะขะฐะฑะปะธัั: pages, kpi
โ   โโโ routers/
โ   โ   โโโ admin_router.py     # ะญะฝะดะฟะพะธะฝัั: KPI, ัะพะทะดะฐะฝะธะต ัััะฐะฝะธั
โ   โโโ schemas/
โ   โ   โโโ schemas.py          # Pydantic-ะผะพะดะตะปะธ
โ   โโโ migrations/             # Alembic
โ   โโโ alembic.ini
โ   โโโ requirements.txt
โ   โโโ .env
โ
โโโ frontend/
โ   โโโ public/
โ   โโโ src/
โ   โ   โโโ components/
โ   โ   โ   โโโ StatsPage.js    # ะัะพะฑัะฐะถะตะฝะธะต ััะฐัะธััะธะบะธ
โ   โ   โ   โโโ Sidebar.js
โ   โ   โ   โโโ ...
โ   โ   โโโ App.js              # ะะพะณะธะบะฐ: ัะฐะนะผะตั, ะพะฑะฝะพะฒะปะตะฝะธะต KPI
โ   โ   โโโ ...
โ   โโโ package.json
โ   โโโ ...
โ
โโโ README.md                   # ะญัะพั ัะฐะนะป
โโโ .gitignore
```

---

๐ ะะฐะบ ัะฐะฑะพัะฐะตั ััะฐัะธััะธะบะฐ?
ะัะธ ะทะฐัะพะดะต ะฝะฐ ะฒะบะปะฐะดะบั:  
โ GET /admin/pages/{id} โ ัะฒะตะปะธัะธะฒะฐะตั visits  
ะัะธ ััะพะดะต:
โ ะัะฟัะฐะฒะปัะตััั POST /admin/kpi/{id}/time ั ะบะพะปะธัะตััะฒะพะผ ัะตะบัะฝะด  
ะะฐ ะฒะบะปะฐะดะบะต /stats:
โ GET /admin/kpis โ ะพัะพะฑัะฐะถะฐะตั ะฒัะต ะดะฐะฝะฝัะต

---

## ๐ CORS

ะะฐัััะพะตะฝะพ ะฒ `backend/main.py`:  
python app.add_middleware( CORSMiddleware, allow_origins=["http://localhost:3000"], allow_methods=["*"], allow_headers=["*"], )


---

## โ ะงัะพ ัะตะฐะปะธะทะพะฒะฐะฝะพ?

| ะคัะฝะบัะธะพะฝะฐะป | ะะตะฐะปะธะทะพะฒะฐะฝะพ | 
|--------------------------------------------|-------------| 
| ะะฐะฒะธะณะฐัะธะพะฝะฝะฐั ะฟะฐะฝะตะปั | โ | 
| FastAPI-ัะตัะฒะตั | โ | 
| React โ ัะตัะฒะตั | โ | 
| ะะฐะณััะทะบะฐ ะธ ะธะฝะฒะตััะธัะพะฒะฐะฝะธะต ะธะทะพะฑัะฐะถะตะฝะธะน | โ | 
| ะะพะบัะผะตะฝัะฐัะธั API (/docs, /redoc) | โ | 
| ะะตะผะพะธะทะฐัะธั (useMemo) | โ | 
| ะะพะดะดะตัะถะบะฐ fetch | โ | 
| ะะฐะทะฐ ะดะฐะฝะฝัั (PostgreSQL) | โ | 
| ะะธะณัะฐัะธะธ (Alembic) | โ | 
| ะกััััะธะบ ะฟะพัะตัะตะฝะธะน | โ | 
| ะฃััั ะฒัะตะผะตะฝะธ ะฝะฐ ัััะฐะฝะธัะต | โ | 
| ะะบะปะฐะดะบะฐ "ะกัะฐัะธััะธะบะฐ" | โ |
---

## ๐ ะกััะปะบะธ

- [FastAPI ะดะพะบัะผะตะฝัะฐัะธั](https://fastapi.tiangolo.com/)
- [JSONPlaceholder](https://jsonplaceholder.typicode.com/)
- [React OpenAPI Renderer](https://github.com/tamediadigital/react-openapi-renderer) (ะฐะปััะตัะฝะฐัะธะฒะฐ)
- [Pillow (PIL)](https://pillow.readthedocs.io/) โ ะพะฑัะฐะฑะพัะบะฐ ะธะทะพะฑัะฐะถะตะฝะธะน

---

## ๐ ะะธัะตะฝะทะธั

ะัะพะตะบั ัะฐัะฟัะพัััะฐะฝัะตััั ะฟะพะด ะปะธัะตะฝะทะธะตะน MIT. ะะพะดัะพะฑะฝะพััะธ ะฒ ัะฐะนะปะต `LICENSE`.